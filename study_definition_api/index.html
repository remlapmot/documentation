
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.0">
    
    
      
        <title>Full API - OpenSAFELY documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bc7e593a.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab28b872.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#full-api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="OpenSAFELY documentation" class="md-header-nav__button md-logo" aria-label="OpenSAFELY documentation">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            OpenSAFELY documentation
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Full API
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="OpenSAFELY documentation" class="md-nav__button md-logo" aria-label="OpenSAFELY documentation">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    OpenSAFELY documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." class="md-nav__link">
      Introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      How OpenSAFELY works
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="How OpenSAFELY works" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        How OpenSAFELY works
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../open-methods/" class="md-nav__link">
      Our philosophy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../coming-soon/" class="md-nav__link">
      Not just another TRE
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../security-levels/" class="md-nav__link">
      Security
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../workflow/" class="md-nav__link">
      Analysis workflow
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Data sources
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Data sources" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Data sources
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dataset-intro/" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dataset-systmone/" class="md-nav__link">
      Primary care records
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dataset-sgsscovid/" class="md-nav__link">
      Covid-19 test results
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dataset-ecds/" class="md-nav__link">
      Emergency attendances
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dataset-apc/" class="md-nav__link">
      Hospital admissions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dataset-icnarc/" class="md-nav__link">
      Intensive care admissions (covid-19 only)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dataset-cpns/" class="md-nav__link">
      In-hospital deaths (covid-19 only)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dataset-onsdeaths/" class="md-nav__link">
      Registered deaths
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Installation
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Installation" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../install-intro/" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install-github-and-git/" class="md-nav__link">
      GitHub and Git
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install-python/" class="md-nav__link">
      Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install-docker/" class="md-nav__link">
      Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../opensafely-cli/" class="md-nav__link">
      OpenSAFELY CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../install-macos/" class="md-nav__link">
      macOS
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../repositories/" class="md-nav__link">
      Project repositories
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../study-def/" class="md-nav__link">
      Study definitions
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../study-def-variables/" class="md-nav__link">
      Study definition variable reference
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../cohortextractor/" class="md-nav__link">
      cohortextractor
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../study-def-flowcharts/" class="md-nav__link">
      Inclusion/exclusion flow charts
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../measures/" class="md-nav__link">
      Measures
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      Codelists
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Codelists" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        <span class="md-nav__icon md-icon"></span>
        Codelists
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../codelist-intro/" class="md-nav__link">
      Introduction to codelists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../codelist-creation/" class="md-nav__link">
      Building a codelist
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../codelist-project/" class="md-nav__link">
      Adding codelists to Project
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../codelist-snomed/" class="md-nav__link">
      SNOMED codelists
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../pipelines/" class="md-nav__link">
      Running and testing code
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../releasing-files/" class="md-nav__link">
      Releasing files from the server
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-14" type="checkbox" id="nav-14">
    
    <label class="md-nav__link" for="nav-14">
      Good Practice
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Good Practice" data-md-level="1">
      <label class="md-nav__title" for="nav-14">
        <span class="md-nav__icon md-icon"></span>
        Good Practice
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../good-practice-intro/" class="md-nav__link">
      Good practice
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../open-data-manifesto/" class="md-nav__link">
      The Datalab Open Manifesto
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../protocol/" class="md-nav__link">
      Developing a protocol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../git-workflow/" class="md-nav__link">
      Using Git effectively
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../code-reviews/" class="md-nav__link">
      Code reviews
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-15" type="checkbox" id="nav-15">
    
    <label class="md-nav__link" for="nav-15">
      Feature requests, bug reports
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Feature requests, bug reports" data-md-level="1">
      <label class="md-nav__title" for="nav-15">
        <span class="md-nav__icon md-icon"></span>
        Feature requests, bug reports
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../requests-intro/" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../requests-packages/" class="md-nav__link">
      Adding packages
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../requests-variables/" class="md-nav__link">
      Adding Study Definition variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../requests-documentation/" class="md-nav__link">
      Updating the Documentation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cohortextractor.patients" class="md-nav__link">
    patients
  </a>
  
    <nav class="md-nav" aria-label="patients">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.address_as_of" class="md-nav__link">
    address_as_of()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.admitted_to_hospital" class="md-nav__link">
    admitted_to_hospital()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.admitted_to_icu" class="md-nav__link">
    admitted_to_icu()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.age_as_of" class="md-nav__link">
    age_as_of()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.all" class="md-nav__link">
    all()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.attended_emergency_care" class="md-nav__link">
    attended_emergency_care()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.care_home_status_as_of" class="md-nav__link">
    care_home_status_as_of()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.categorised_as" class="md-nav__link">
    categorised_as()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.date_deregistered_from_all_supported_practices" class="md-nav__link">
    date_deregistered_from_all_supported_practices()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.date_of" class="md-nav__link">
    date_of()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.date_of_birth" class="md-nav__link">
    date_of_birth()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.died_from_any_cause" class="md-nav__link">
    died_from_any_cause()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.household_as_of" class="md-nav__link">
    household_as_of()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.maximum_of" class="md-nav__link">
    maximum_of()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.mean_recorded_value" class="md-nav__link">
    mean_recorded_value()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.minimum_of" class="md-nav__link">
    minimum_of()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.most_recent_bmi" class="md-nav__link">
    most_recent_bmi()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.random_sample" class="md-nav__link">
    random_sample()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.registered_as_of" class="md-nav__link">
    registered_as_of()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.registered_practice_as_of" class="md-nav__link">
    registered_practice_as_of()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.registered_with_one_practice_between" class="md-nav__link">
    registered_with_one_practice_between()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.satisfying" class="md-nav__link">
    satisfying()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.sex" class="md-nav__link">
    sex()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.with_complete_gp_consultation_history_between" class="md-nav__link">
    with_complete_gp_consultation_history_between()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.with_complete_history_between" class="md-nav__link">
    with_complete_history_between()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.with_death_recorded_in_cpns" class="md-nav__link">
    with_death_recorded_in_cpns()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.with_death_recorded_in_primary_care" class="md-nav__link">
    with_death_recorded_in_primary_care()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.with_gp_consultations" class="md-nav__link">
    with_gp_consultations()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.with_high_cost_drugs" class="md-nav__link">
    with_high_cost_drugs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.with_test_result_in_sgss" class="md-nav__link">
    with_test_result_in_sgss()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.with_these_clinical_events" class="md-nav__link">
    with_these_clinical_events()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.with_these_codes_on_death_certificate" class="md-nav__link">
    with_these_codes_on_death_certificate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.with_these_medications" class="md-nav__link">
    with_these_medications()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cohortextractor.patients.with_tpp_vaccination_record" class="md-nav__link">
    with_tpp_vaccination_record()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="full-api">Full API<a class="headerlink" href="#full-api" title="Permanent link">&#128279;</a></h1>
<div class="doc doc-object doc-module">
<h4 class="doc doc-heading" id="cohortextractor.patients">

        <code>patients</code>


      <a class="headerlink" href="#cohortextractor.patients" title="Permanent link">&#128279;</a></h4>
<div class="doc doc-contents first">
<p>This module provides the methods for making a study definition</p>
<p>These methods don't <em>do</em> anything; they just return their name and arguments.
This provides a friendlier API than having to build some big nested data
structure by hand and means we can make use of autocomplete, docstrings etc to
make it a bit more discoverable.</p>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.address_as_of">

        <code class="highlight language-python">
address_as_of<span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">returning</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">round_to_nearest</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.address_as_of" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Return patients' address characteristics such as IMD as of a particular date</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>date</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to the given date.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>returning</code></td>
<td>
<p>a str defining the type of data to be returned. options include <code>index_of_multiple_deprivation</code>
<code>rural_urban_classification</code>, and <code>msoa</code>. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>round_to_nearest</code></td>
<td>
<p>an integer that represents how <code>index_of_multiple_deprivation</code> value are rounded.
Only use when returning is <code>index_of_multiple_deprivation</code></p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dict defining the <code>rate</code> and the <code>categories</code> returned with ratios</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of integers for <code>rural_urban_classification</code> and <code>index_of_multiple_deprivation</code>, strings for <code>msoa</code></p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ValueError</code></td>
<td>
<p>if unsupported <code>returning</code> argument is provided</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>This creates a variable called <code>imd</code> based on patient address.</p>
<div class="highlight">
<pre><span></span><code>imd=patients.address_as_of(
    "2020-02-29",
    returning="index_of_multiple_deprivation",
    round_to_nearest=100,
    return_expectations={
        "rate": "universal",
        "category": {"ratios": {"100": 0.1, "200": 0.2, "300": 0.7}},
    },
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.admitted_to_hospital">

        <code class="highlight language-python">
admitted_to_hospital<span class="p">(</span><span class="n">on_or_before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_after</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">returning</span><span class="o">=</span><span class="s1">'binary_flag'</span><span class="p">,</span> <span class="n">find_first_match_in_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">find_last_match_in_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">with_these_diagnoses</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">with_these_primary_diagnoses</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">with_these_procedures</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.admitted_to_hospital" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Return information about admission to hospital.</p>
<p>See https://github.com/opensafely/cohort-extractor/issues/186 for in-depth discussion and background.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>on_or_before</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to
on or before the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>on_or_after</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to
on or after the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>between</code></td>
<td>
<p>two dates of interest as a list with each date as a string with the format <code>YYYY-MM-DD</code>.
Filters results to between the two dates provided. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>returning</code></td>
<td>
<p>a string indicating what type of value should be returned. Options for <code>returning</code> are:
binary_flag: if they were admitted at all
date_admitted: date patient admitted to hospital
date_discharged: date patient discharged from hospital
number_of_matches_in_period: number of times patient was admitted in time period specified
primary_diagnosis: primary diagnosis code for admission</p>
</td>
<td><code>'binary_flag'</code></td>
</tr>
<tr>
<td><code>find_first_match_in_period</code></td>
<td>
<p>a boolean that indicates if the data returned is first event
if there are multiple matches within the time period</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>find_last_match_in_period</code></td>
<td>
<p>a boolean that indicates if the data returned is last event
if there are multiple matches within the time period</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>date_format</code></td>
<td>
<p>a string detailing the format of the dates to be returned. It can be <code>YYYY-MM-DD</code>,
<code>YYYY-MM</code> or <code>YYYY</code> and wherever possible the least disclosive data should be returned. i.e returning
only year is less disclosive than a date with day, month and year.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>with_these_diagnoses</code></td>
<td>
<p>icd10 codes to match against any diagnosis</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>with_these_primary_diagnoses</code></td>
<td>
<p>icd10 codes to match against the primary diagnosis</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>with_these_procedures</code></td>
<td>
<p>opcs4 codes to match against the procedure</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary defining the incidence and distribution of expected value
within the population in question.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of integers of <code>1</code> or <code>0</code> if <code>returning</code> argument is set to <code>binary_flag</code>; list of strings with a
    date format returned if <code>returning</code> argument is set to <code>date_admitted</code> or <code>date_discharged</code>; of
    integers if <code>returning</code> argument is set to <code>number_of_matches_in_period</code>. list of strings with
    alphanumerical code format for ICD10 code if <code>returning</code> argument is set to <code>primary_diagnosis</code></p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>The day of each patient's first hospital admission for Covid19:</p>
<div class="highlight">
<pre><span></span><code>covid_admission_date=patients.admitted_to_hospital(
    returning= "date_admitted",
    with_these_diagnoses=covid_codelist,
    on_or_after="2020-02-01",
    find_first_match_in_period=True,
    date_format="YYYY-MM-DD",
    return_expectations={"date": {"earliest": "2020-03-01"}},
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.admitted_to_icu">

        <code class="highlight language-python">
admitted_to_icu<span class="p">(</span><span class="n">on_or_after</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">find_first_match_in_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">find_last_match_in_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">returning</span><span class="o">=</span><span class="s1">'binary_flag'</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_month</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_day</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.admitted_to_icu" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Return information about being admitted to ICU.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>on_or_before</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results
on or before the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>on_or_after</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results
on or after the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>between</code></td>
<td>
<p>two dates of interest as a list with each date as a string with the format <code>YYYY-MM-DD</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>find_first_match_in_period</code></td>
<td>
<p>a boolean that indicates if the data returned is first admission to icu if
there are multiple admissions within the time period</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>find_last_match_in_period</code></td>
<td>
<p>a boolean that indicates if the data returned is last admission to icu if
there are multiple admissions within the time period</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>returning</code></td>
<td>
<p>binary_flag: Whether patient attended A&amp;E
date_admitted: Date patient arrived in A&amp;E
had_respiratory_support: Whether patient received any form of respiratory support
had_basic_respiratory_support: Whether patient received "basic" respiratory support
had_advanced_respiratory_support: Whether patient received "advanced" respiratory support
(Note that the terms "basic" and "advanced" are derived from the underlying ICNARC data.)</p>
</td>
<td><code>'binary_flag'</code></td>
</tr>
<tr>
<td><code>date_format</code></td>
<td>
<p>a string detailing the format of the dates to be returned. It can be <code>YYYY-MM-DD</code>,
<code>YYYY-MM</code> or <code>YYYY</code> and wherever possible the least disclosive data should be returned. i.e returning
only year is less disclosive than a date with day, month and year. Only used if
<code>returning</code> is <code>binary_flag</code></p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary defining the incidence and distribution of expected value
within the population in question. This is a 2-item key-value dictionary of <code>date</code> and <code>rate</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>include_month</code></td>
<td>
<p>a boolean indicating if day should be included in addition to year (deprecated: use
<code>date_format</code> instead).</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>include_day</code></td>
<td>
<p>a boolean indicating if day should be included in addition to year and
month (deprecated: use <code>date_format</code> instead).</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of integers of <code>1</code> or <code>0</code> if <code>returning</code> argument is set to <code>binary_flag</code>, <code>had_respiratory_support</code>,
<code>had_basic_respiratory_support</code> or <code>had_advanced_respiratory_support</code>; list of strings with a date format
returned if <code>returning</code> argument is set to <code>date_admitted</code></p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>This returns two variables &mdash; one called <code>icu_date_admitted</code> and another <code>had_resp_support</code>:</p>
<div class="highlight">
<pre><span></span><code>has_resp_support=patients.admitted_to_icu(
    on_or_after="2020-02-01",
    find_first_match_in_period=True,
    returning="had_respiratory_support",
    return_expectations={
            "date": {"earliest" : "2020-02-01"},
            "rate" : "exponential_increase"
    },
),

icu_date_admitted=patients.admitted_to_icu(
    on_or_after="2020-02-01",
    find_first_match_in_period=True,
    returning="date_admitted",
    date_format="YYYY-MM-DD",
    return_expectations={
        "date": {"earliest" : "2020-02-01"},
        "rate" : "exponential_increase"
   },
),
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.age_as_of">

        <code class="highlight language-python">
age_as_of<span class="p">(</span><span class="n">reference_date</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.age_as_of" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Returns age of patient of at a particular date. Note can be negative if born after <code>reference_date</code>.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>reference_date</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code></p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dict defining an expectation definition that includes at least a rate
and a distribution. If <code>distribution</code> is defined as "population_ages" it returns likely distribution
based on known UK age bands in 2018 (see file: "uk_population_bands_2018.csv")</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>ages as integers</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>This creates a variable "age" with all patient returning an age as an integer:</p>
<div class="highlight">
<pre><span></span><code>age=patients.age_as_of(
    "2020-02-01",
    return_expectations={
        "rate" : "universal",
        "int" : {"distribution" : "population_ages"}
    }
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.all">

        <code class="highlight language-python">
all<span class="p">()</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.all" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">

    </div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.attended_emergency_care">

        <code class="highlight language-python">
attended_emergency_care<span class="p">(</span><span class="n">on_or_before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_after</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">returning</span><span class="o">=</span><span class="s1">'binary_flag'</span><span class="p">,</span> <span class="n">find_first_match_in_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">find_last_match_in_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">with_these_diagnoses</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">discharged_to</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.attended_emergency_care" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Return information about attendance of A&amp;E from the ECDS dataset. Please note that there is a limited
number of diagnoses allowed within this dataset, and so will not match with the range of diagnoses allowed
in other datasets such as the primary care record.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>on_or_before</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to
on or before the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>on_or_after</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to
on or after the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>between</code></td>
<td>
<p>two dates of interest as a list with each date as a string with the format <code>YYYY-MM-DD</code>.
Filters results to between the two dates provided. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>returning</code></td>
<td>
<p>a string indicating what type of value should be returned. Options for <code>returning</code> are:
binary_flag: Whether patient attended A&amp;E
date_arrived: date patient arrived in A&amp;E
number_of_matches_in_period: number of times patient attended A&amp;E
discharge_destination: <abbr title="SNOMED Clinical Terms, a structured clinical vocabulary for use in an electronic health record, the current standard for coding in the NHS and many jurisdictions globally">SNOMED</abbr> CT code of discharge destination.  This
                       will be a member of refset 999003011000000105.</p>
</td>
<td><code>'binary_flag'</code></td>
</tr>
<tr>
<td><code>find_first_match_in_period</code></td>
<td>
<p>a boolean that indicates if the data returned is first event
if there are multiple matches within the time period</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>find_last_match_in_period</code></td>
<td>
<p>a boolean that indicates if the data returned is last event
if there are multiple matches within the time period</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>date_format</code></td>
<td>
<p>a string detailing the format of the dates to be returned. It can be <code>YYYY-MM-DD</code>,
<code>YYYY-MM</code> or <code>YYYY</code> and wherever possible the least disclosive data should be returned. i.e returning
only year is less disclosive than a date with day, month and year.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>with_these_diagnoses</code></td>
<td>
<p>a list of SNOMED CT codes</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>discharged_to</code></td>
<td>
<p>a list of members of refset 999003011000000105.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary defining the incidence and distribution of expected value
within the population in question.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of integers of <code>1</code> or <code>0</code> if <code>returning</code> argument is set to <code>binary_flag</code>; list of strings with a
    date format returned if <code>returning</code> argument is set to <code>date_arrived</code>; of integers if <code>returning</code>
    argument is set to <code>number_of_matches_in_period</code> or <code>discharge_destination</code> (with <abbr title="SNOMED Clinical Terms, a structured clinical vocabulary for use in an electronic health record, the current standard for coding in the NHS and many jurisdictions globally">SNOMED</abbr> CT code as
    a numerical value)</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>A variable called <code>emergency_care</code> is created with returns a date of first attendence in A&amp;E if
patient had attended emergency room during the time period.</p>
<div class="highlight">
<pre><span></span><code>emergency_care=patients.attended_emergency_care(
    on_or_after="2020-01-01",
    returning="date_arrived",
    date_format="YYYY-MM-DD",
    find_first_match_in_period=True,
    return_expectations={
        "date": {"earliest" : "2020-02-01"},
        "rate" : "exponential_increase"
    },
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.care_home_status_as_of">

        <code class="highlight language-python">
care_home_status_as_of<span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">categorised_as</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.care_home_status_as_of" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>TPP have attempted to match patient addresses to care homes as stored in
the CQC database. At its most simple this query returns a boolean
indicating whether the patient's address (as of the supplied time) matched
with a care home.</p>
<p>It is also possible return a more complex categorisation based on
attributes of the care homes in the CQC database, which can be freely
downloaded here:
https://www.cqc.org.uk/about-us/transparency/using-cqc-data</p>
<p>At present the only imported fields are:
    LocationRequiresNursing
    LocationDoesNotRequireNursing</p>
<p>But we can ask for more fields to be imported if needed.</p>
<p>The <code>categorised_as</code> argument acts in effectively the same way as for the
<code>categorised_as</code> function except that the only columns that can be referred
to are those belonging to the care home table (i.e. the two nursing fields
above) and the boolean <code>IsPotentialCareHome</code></p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>date</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to the given date</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>categorised_as</code></td>
<td>
<p>a logic expression that applies an algorithm to specific variables to create categories</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dict defining the <code>rate</code> and the <code>categories</code> returned with ratios</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of strings which each letter representing a category as defined by the algorithm</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>This creates a variable called <code>care_home_type</code> which contains a 2 letter string which represents a type of care home environment.</p>
<div class="highlight">
<pre><span></span><code>care_home_type=patients.care_home_status_as_of(
    "2020-02-01",
    categorised_as={
        "PC":
        """
          IsPotentialCareHome
          AND LocationDoesNotRequireNursing='Y'
          AND LocationRequiresNursing='N'
        """,
        "PN":
        """
          IsPotentialCareHome
          AND LocationDoesNotRequireNursing='N'
          AND LocationRequiresNursing='Y'
        """,
        "PS": "IsPotentialCareHome",
        "U": "DEFAULT",
    },
    return_expectations={
        "rate": "universal",
        "category": {"ratios": {"PC": 0.05, "PN": 0.05, "PS": 0.05, "U": 0.85,},},
    },
),
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.categorised_as">

        <code class="highlight language-python">
categorised_as<span class="p">(</span><span class="n">category_definitions</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">extra_columns</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.categorised_as" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Patients who had had 1 or more code from 1 or more codelists are categorised into
groups according to a prescribed algorithm.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>category_definitions</code></td>
<td>
<p>a dict that defines the algorithm and the associated category
The keys of the dict are strings representing categories from a defined by other
arguments such as <code>with_these_clinical_events</code>. The values are expressions of logic using
statements and AND/OR statements. A default argument should be provided if a particular
patient cannot be categorised to the algorithm.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dict that defined the ratios of each category. The keys are the category values
as strings and the values are ratios as floats. The ratios should add up to 1.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<div class="admonition retyrns">
<p class="admonition-title">Retyrns</p>
<p>list: of strings which each letter representing a category as defined by the algorithm</p>
</div>
<p><strong>Examples:</strong></p>
<p>This creates a variable of asthma status based on codes for asthma and categorising for recent steroid use.</p>
<div class="highlight">
<pre><span></span><code>current_asthma=patients.categorised_as(
    {
        "1": "DEFAULT",
        "2": "recent_asthma_code AND
              prednisolone_last_year = 0"
        "3": "recent_asthma_code AND prednisolone_last_year &gt; 0"
    },
    recent_asthma_code=patients.with_these_clinical_events(
        asthma_codes, between=["2017-02-01", "2020-01-31"],
    ),
    prednisolone_last_year=patients.with_these_medications(
        pred_codes,
        between=["2019-02-01", "2020-01-31"],
        returning="number_of_matches_in_period",
    ),
    return_expectations={
        "category":{"ratios": {"0": 0.8, "1": 0.1, "2": 0.1}}
    },
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.date_deregistered_from_all_supported_practices">

        <code class="highlight language-python">
date_deregistered_from_all_supported_practices<span class="p">(</span><span class="n">on_or_before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_after</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.date_deregistered_from_all_supported_practices" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Returns the date (if any) on which the patient de-registered from all
practices for which OpenSAFELY has data. Events which occur in primary care
after this date will not be recorded in the platform (though there may be
data from other sources e.g. SGSS, CPNS).</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>on_or_before</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to
on or before the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>on_or_after</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to
on or after the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>between</code></td>
<td>
<p>two dates of interest as a list with each date as a string with the format <code>YYYY-MM-DD</code>.
Filters results to between the two dates provided. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>date_format</code></td>
<td>
<p>a string detailing the format of the dates to be returned. It can be <code>YYYY-MM-DD</code>,
<code>YYYY-MM</code> or <code>YYYY</code> and wherever possible the least disclosive data should be returned. i.e returning
only year is less disclosive than a date with day, month and year.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary defining the incidence and distribution of expected value
within the population in question.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of strings with a date format returned if patient had deregistered, otherwise empty</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>A variable called <code>dereg_date</code> is created with returns a date of de-registration if patient has
deregistered from a practice within the dataset within the specified time period.</p>
<div class="highlight">
<pre><span></span><code>dereg_date=patients.date_deregistered_from_all_supported_practices(
    on_or_after="2020-03-01",
    date_format="YYYY-MM",
    return_expectations={
        {"date": {"earliest": "2020-03-01"},
        "incidence": 0.05
    }
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.date_of">

        <code class="highlight language-python">
date_of<span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_month</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_day</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.date_of" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">

    </div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.date_of_birth">

        <code class="highlight language-python">
date_of_birth<span class="p">(</span><span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.date_of_birth" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Returns date of birth as a string with format "YYYY-MM"</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>date_format</code></td>
<td>
<p>a string detailing the format of the dates for date of birth to be returned.
It can be "YYYY-MM" or "YYYY" and wherever possible the least disclosive data should be
returned. i.e returning only year is less disclosive than a date with month and year.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary containing an expectation definition defining a rate and a distribution</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>dates as strings with "YYYY-MM" format</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ValueError</code></td>
<td>
<p>if Date of Birth is attempted to be returned with a <code>YYYY-MM-DD</code> format.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>This creates a variable <code>dob</code> with all patient returning a year and month as a string:</p>
<div class="highlight">
<pre><span></span><code>dob=patients.date_of_birth(
    "YYYY-MM",
    return_expectations={
        "date": {"earliest": "1950-01-01", "latest": "today"},
        "rate": "uniform",
    }
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.died_from_any_cause">

        <code class="highlight language-python">
died_from_any_cause<span class="p">(</span><span class="n">on_or_before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_after</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">returning</span><span class="o">=</span><span class="s1">'binary_flag'</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_month</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_day</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.died_from_any_cause" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Identify patients who with ONS-registered deaths</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>on_or_before</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results
on or before the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>on_or_after</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results
on or after the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>between</code></td>
<td>
<p>two dates of interest as a list with each date as a string with the format <code>YYYY-MM-DD</code>.
Filters results to between the two dates provided. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>returning</code></td>
<td>
<p>a string indicating what type of value should be returned. The options are:
date_of_death: Date of death
binary_flag: If they died or not</p>
</td>
<td><code>'binary_flag'</code></td>
</tr>
<tr>
<td><code>date_format</code></td>
<td>
<p>a string detailing the format of the dates to be returned. It can be <code>YYYY-MM-DD</code>,
<code>YYYY-MM</code> or <code>YYYY</code> and wherever possible the least disclosive data should be returned. i.e returning
only year is less disclosive than a date with day, month and year.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>include_month</code></td>
<td>
<p>a boolean indicating if day should be included in addition to year (deprecated: use
<code>date_format</code> instead).</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>include_day</code></td>
<td>
<p>a boolean indicating if day should be included in addition to year and
month (deprecated: use <code>date_format</code> instead).</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary defining the incidence and distribution of expected value
within the population in question.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of integers of <code>1</code> or <code>0</code> if <code>returning</code> argument is set to <code>binary_flag</code>;
    list of strings with a date format returned if <code>returning</code> argument is set to <code>date_of_death</code></p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>A variable called <code>died_any</code> is created that returns the date of death for
any patients that have died in the time period.</p>
<div class="highlight">
<pre><span></span><code>died_any=patients.died_from_any_cause(
    on_or_after="2020-02-01",
    returning="date_of_death",
    date_format="YYYY-MM-DD",
    return_expectations={
        "date": {"earliest" : "2020-02-01"},
        "rate" : "exponential_increase"
    },
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.household_as_of">

        <code class="highlight language-python">
household_as_of<span class="p">(</span><span class="n">reference_date</span><span class="p">,</span> <span class="n">returning</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.household_as_of" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<div class="highlight">
<pre><span></span><code>Return information about the household to which the patient belonged as of
the reference date. This is inferred from address data using an algorithm
developed by TPP (to be documented soon) so the results are not 100%
reliable but are apparently pretty good.

!!! args
    reference_date: date of interest as a string with the format `YYYY-MM-DD`. Filters results to a particular
    set date
    !!! returning "a string indicating what type of value should be returned. The options for `returning` are:"
        !!! pseudo_id "An integer identifier for the household which has no meaning"
                   other than to identify individual members of the same
                   household (0 if no household information available)
        !!! household_size "the number of individuals in the household (0 if no"
                        household information available)
        !!! is_prison "Boolean indicating whether household is a prison.  See"
                   https://github.com/opensafely/cohort-extractor/issues/271#issuecomment-679069981
                   for details of how this is determined.
        !!! has_members_in_other_ehr_systems "Boolean indicating whether some household"
                                          members are registered with GPs using a
                                          different EHR system, meaning that our
                                          coverage of the household is incomplete.
        !!! percentage_of_members_with_data_in_this_backend "Integer giving the (estimated)"
                                                         percentage of household members
                                                         where we have EHR data available
                                                         in this backend (i.e. not in other
                                                         systems as above)
        msoa: Returns the MSOA (Middle Super Output Area) in which the household is
          situated
    return_expectations: a dictionary defining the incidence and distribution of expected value
    within the population in question.
</code></pre>
</div>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of integers if <code>returning</code> argument is set to <code>pseudo_id</code>, <code>household_size</code> or
<code>percentage_of_members_with_data_in_this_backend</code>. a list of <code>1</code> or <code>0</code> is <code>returning</code> is set to
<code>is_prison</code> or <code>has_members_in_other_ehr_systems</code></p>
<p>Examples:</p>
<div class="highlight">
<pre><span></span><code>household_id=patients.household_as_of(
    "2020-02-01", returning="pseudo_id"
)

household_size=patients.household_as_of(
    "2020-02-01", returning="household_size"
),
</code></pre>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.maximum_of">

        <code class="highlight language-python">
maximum_of<span class="p">(</span><span class="o">*</span><span class="n">column_names</span><span class="p">,</span> <span class="o">**</span><span class="n">extra_columns</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.maximum_of" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Return the maximum value over the supplied columns e.g</p>
<p>max_value=patients.maximum_of("some_column", "another_column")</p>
<p>Additional columns can be defined within the function call which will be
used in computing the maximum but won't themselves appear in the output:</p>
<p>max_value=patients.maximum_of(
      "some_column",
      another_colum=patients.with_these_medications(...)
  )</p>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.mean_recorded_value">

        <code class="highlight language-python">
mean_recorded_value<span class="p">(</span><span class="n">codelist</span><span class="p">,</span> <span class="n">on_most_recent_day_of_measurement</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_after</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_measurement_date</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_month</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_day</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.mean_recorded_value" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Return patients' mean recorded value of a numerical value as defined by
a codelist on a particular day within the defined period. This is important as allows
us to account for multiple measurements taken on one day.</p>
<p>The date of the measurement can be included by flagging with date format options.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>codelist</code></td>
<td>
<p>a codelist for requested value</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>on_most_recent_day_of_measurement</code></td>
<td>
<p>boolean flag for requesting measurements be on most recent date</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary defining the incidence and distribution of expected value
within the population in question. This is a 3-item key-value dictionary of "date" and "float".
"date" is dictionary itself and should contain the <code>earliest</code> and <code>latest</code> dates needed in the
dummy data. <code>float</code> is a dictionary of <code>distribution</code>, <code>mean</code>, and <code>stddev</code>. These values determine
the shape of the dummy data returned, and the float means a float will be returned rather than an
integer. <code>incidence</code> must have a value and this is what percentage of dummy patients have
a value. It needs to be a number between 0 and 1.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>on_or_before</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to measurements
on or before the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>on_or_after</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to measurements
on or after the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>between</code></td>
<td>
<p>two dates of interest as a list with each date as a string with the format <code>YYYY-MM-DD</code>.
Filters results to measurements between the two dates provided. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>include_measurement_date</code></td>
<td>
<p>a boolean indicating if an extra column, named <code>date_of_bmi</code>,
should be included in the output. The default value is <code>False</code>.</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>date_format</code></td>
<td>
<p>a string detailing the format of the dates to be returned. It can be <code>YYYY-MM-DD</code>,
<code>YYYY-MM</code> or <code>YYYY</code> and wherever possible the least disclosive data should be returned. i.e returning
only year is less disclosive than a date with day, month and year. Only used if
include_measurement_date is <code>True</code></p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>include_month</code></td>
<td>
<p>a boolean indicating if day should be included in addition to year (deprecated: use
<code>date_format</code> instead).</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>include_day</code></td>
<td>
<p>a boolean indicating if day should be included in addition to year and
month (deprecated: use <code>date_format</code> instead).</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>float</code></td>
<td>
<p>mean of value</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>This creates a variable <code>bp_sys</code> returning a float of the most recent systolic blood pressure from
the record within the time period. In the event of repeated measurements on the same day, these
are averaged. Patient who do not have this information
available do not return a value:</p>
<div class="highlight">
<pre><span></span><code>bp_sys=patients.mean_recorded_value(
    systolic_blood_pressure_codes,
    on_most_recent_day_of_measurement=True,
    between=["2017-02-01", "2020-01-31"],
    include_measurement_date=True,
    date_format="YYYY-MM",
    return_expectations={
        "float": {"distribution": "normal", "mean": 80, "stddev": 10},
        "date": {"earliest": "2019-02-01", "latest": "2020-01-31"},
        "incidence": 0.95,
    },
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.minimum_of">

        <code class="highlight language-python">
minimum_of<span class="p">(</span><span class="o">*</span><span class="n">column_names</span><span class="p">,</span> <span class="o">**</span><span class="n">extra_columns</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.minimum_of" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Return the minimum value over the supplied columns e.g</p>
<p>min_value=patients.minimum_of("some_column", "another_column")</p>
<p>Note: this ignores "empty values" (i.e. the values used if there is no data
for a particular column, such as 0.0 for numeric values or the empty string
for dates). This ensures that the minimum of a column with a defined value
and one with a missing value is equal to the defined value.</p>
<p>Additional columns can be defined within the function call which will be
used in computing the minimum but won't themselves appear in the output:</p>
<p>min_value=patients.minimum_of(
      "some_column",
      another_colum=patients.with_these_medications(...)
  )</p>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.most_recent_bmi">

        <code class="highlight language-python">
most_recent_bmi<span class="p">(</span><span class="n">on_or_before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_after</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minimum_age_at_measurement</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_measurement_date</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_month</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_day</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.most_recent_bmi" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Return patients' most recent BMI (in the defined period) either
computed from weight and height measurements or, where they are not
availble, from recorded BMI values. Measurements taken when a patient
was below the minimum age are ignored. The height measurement can be
taken before (but not after) the defined period as long as the patient
was over the minimum age at the time.</p>
<p>The date of the measurement can be obtained using <code>date_of("&lt;bmi-column-name&gt;")</code>.
If the BMI is computed from weight and height then we use the date of the
weight measurement for this.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>on_or_before</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to measurements
on or before the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>on_or_after</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to measurements
on or after the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>between</code></td>
<td>
<p>two dates of interest as a list with each date as a string with the format <code>YYYY-MM-DD</code>.
Filters results to measurements between the two dates provided. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>minimum_age_at_measurement</code></td>
<td>
<p>Measurements taken before this age will not count towards BMI
calculations. It is an integer and the default value is 16.</p>
</td>
<td><code>16</code></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary defining the incidence and distribution of expected BMI
within the population in question. This is a 3-item key-value dictionary of "date" and "float".
"date" is dictionary itself and should contain the <code>earliest</code> and <code>latest</code> dates needed in the
dummy data. <code>float</code> is a dictionary of <code>distribution</code>, <code>mean</code>, and <code>stddev</code>. These values determine
the shape of the dummy data returned, and the float means a float will be returned rather than an
integer. <code>incidence</code> must have a value and this is what percentage of dummy patients have
a BMI. It needs to be a number between 0 and 1.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>include_measurement_date</code></td>
<td>
<p>a boolean indicating if an extra column, named <code>date_of_bmi</code>,
should be included in the output. The default value is <code>False</code>.</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>date_format</code></td>
<td>
<p>a string detailing the format of the dates to be returned. It can be <code>YYYY-MM-DD</code>,
<code>YYYY-MM</code> or <code>YYYY</code> and wherever possible the least disclosive data should be returned. i.e returning
only year is less disclosive than a date with day, month and year. Only used if
include_measurement_date is <code>True</code></p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>include_month</code></td>
<td>
<p>a boolean indicating if day should be included in addition to year (deprecated: use
<code>date_format</code> instead).</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>include_day</code></td>
<td>
<p>a boolean indicating if day should be included in addition to year and
month (deprecated: use <code>date_format</code> instead).</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>float</code></td>
<td>
<p>most recent BMI</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>This creates a variable "bmi" returning a float of the most recent bmi calculated from recorded
height and weight, or from a recorded bmi record. Patient who do not have this information
available do not return a value:</p>
<div class="highlight">
<pre><span></span><code>bmi=patients.most_recent_bmi(
    between=["2010-02-01", "2020-01-31"],
    minimum_age_at_measurement=18,
    include_measurement_date=True,
    date_format="YYYY-MM",
    return_expectations={
        "date": {"earliest": "2010-02-01", "latest": "2020-01-31"},
        "float": {"distribution": "normal", "mean": 28, "stddev": 8},
        "incidence": 0.80,
    }
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.random_sample">

        <code class="highlight language-python">
random_sample<span class="p">(</span><span class="n">percent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.random_sample" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Flags a random sample of approximately <code>percent</code> patients.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>percent</code></td>
<td>
<p>an integer between 1 and 100 for the percent of patients to include within the random sample</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dict containing an expectations definition defining at least an <code>incidence</code></p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of integers of <code>1</code> or <code>0</code></p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>This creates a variable <code>example</code>, flagging approximately 10% of the population with the value <code>1</code>:</p>
<div class="highlight">
<pre><span></span><code>example=patients.random_sample(percent=10, expectations={'incidence': 0.1})
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.registered_as_of">

        <code class="highlight language-python">
registered_as_of<span class="p">(</span><span class="n">reference_date</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.registered_as_of" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>All patients registered on the given date. Note this function passes arguments
to registered_with_one_practice_between()</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>reference_date</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to
patients registered at a practice on the given date.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary containing an expectation definition defining an <code>incidence</code>
between <code>0</code> and <code>1</code>.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of integers of <code>1</code> or <code>0</code>.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>This creates a variable "registered" with patient returning an integer of <code>1</code> if patient registered
at date. Patients who are not registered return an integer of <code>0</code>:</p>
<div class="highlight">
<pre><span></span><code>registered=patients.registered_as_of(
    "2020-03-01",
    return_expectations={"incidence": 0.98}
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.registered_practice_as_of">

        <code class="highlight language-python">
registered_practice_as_of<span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">returning</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.registered_practice_as_of" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Return patients' practice address characteristics such as STP or MSOA</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>date</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to the given date.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>returning</code></td>
<td>
<p>a str defining the type of data to be returned. options include <code>msoa</code>, nuts1_region_name,
 and <code>stp_code</code>. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dict defining the <code>rate</code> and the <code>categories</code> returned with ratios</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of strings</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ValueError</code></td>
<td>
<p>if unsupported <code>returning</code> argument is provided</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>This creates a variable called <code>region</code> based on practice address of the patient:</p>
<div class="highlight">
<pre><span></span><code>region=patients.registered_practice_as_of(
    "2020-02-01",
    returning="nuts1_region_name",
    return_expectations={
        "rate": "universal",
        "category": {
            "ratios": {
                "North East": 0.1,
                "North West": 0.1,
                "Yorkshire and the Humber": 0.1,
                "East Midlands": 0.1,
                "West Midlands": 0.1,
                "East of England": 0.1,
                "London": 0.2,
                "South East": 0.2,
            },
        },
    },
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.registered_with_one_practice_between">

        <code class="highlight language-python">
registered_with_one_practice_between<span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.registered_with_one_practice_between" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>All patients registered with the same practice through the given period</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>start_date</code></td>
<td>
<p>start date of interest of period as a string with the format <code>YYYY-MM-DD</code>.
Together with end date, this filters results to patients registered at a practice between two dates</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>end_date</code></td>
<td>
<p>end date of interest of period as a string with the format <code>YYYY-MM-DD</code>.
Together with start date, this filters results to patients registered at a practice between two dates</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary containing an expectation definition defining an <code>incidence</code>
between <code>0</code> and <code>1</code>.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of integers of <code>1</code> or <code>0</code>.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>This creates a variable <code>registered_one</code> with patient returning an integer of <code>1</code> if patient registered
at one practice between two dates. Patients who are not registered return an integer of <code>0</code>.</p>
<div class="highlight">
<pre><span></span><code>registered_one=patients.registered_with_one_practice_between(
    start_date="2020-03-01",
    end_date="2020-06-01",
    return_expectations={"incidence": 0.90}
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.satisfying">

        <code class="highlight language-python">
satisfying<span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">extra_columns</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.satisfying" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Patients who meet the criteria for one or more expressions. Used as a way of combining groups
or making subgroups based on certain characteristics.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>expression</code></td>
<td>
<p>a string in that links together 2 or more expressions into one statement. key variables
for this expression can be defined under this statement or anywhere in study definition.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary defining the rate of expected value
within the population in question</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of integers, either <code>1</code> or <code>0</code></p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>This creates a study population where patients included have asthma and not copd:</p>
<div class="highlight">
<pre><span></span><code>population=patients.satisfying(
    """
    has_asthma AND NOT
    has_copd
    """,
    has_asthma=patients.with_these_clinical_events(
        asthma_codes, between=["2017-02-28", "2020-02-29"],
    has_copd=patients.with_these_clinical_events(
        copd_codes, between=["2017-02-28", "2020-02-29"],
    ),
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.sex">

        <code class="highlight language-python">
sex<span class="p">(</span><span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.sex" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Returns the sex of the patient.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dict containing an expectation definition defining a rate and a ratio for sexes</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p><code>"M"</code> male, <code>"F"</code> female, <code>"I"</code> intersex, or <code>"U"</code> unknown.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>This creates a variable 'sex' with all patients returning a sex of either "M", "F" or ""</p>
<div class="highlight">
<pre><span></span><code>sex=patients.sex(
    return_expectations={
        "rate": "universal",
        "category": {"ratios": {"M": 0.49, "F": 0.51}},
    }
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.with_complete_gp_consultation_history_between">

        <code class="highlight language-python">
with_complete_gp_consultation_history_between<span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.with_complete_gp_consultation_history_between" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>The concept of a "consultation" in EHR systems does not map exactly
to the GP-patient interaction we're interested in (see above) so there is some
processing required on the part of the EHR vendor to produce the
consultation record we need. This does not happen automatically as part of
the GP2GP transfer, and therefore this query can be used to find just those
patients for which the full history is available. This means finding patients
who have been continuously registered with a single TPP-using practice
throughout a time period.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>start_date</code></td>
<td>
<p>start date of interest as a string with the format <code>YYYY-MM-DD</code></p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>end_date</code></td>
<td>
<p>end date of interest as a string with the format <code>YYYY-MM-DD</code></p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary defining the incidence and distribution of expected value
within the population in question.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.with_complete_history_between">

        <code class="highlight language-python">
with_complete_history_between<span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.with_complete_history_between" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>All patients for which we have a full set of records between the given
dates</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>start_date</code></td>
<td>
<p>start date of interest of period as a string with the format <code>YYYY-MM-DD</code>.
Together with end date, this filters results to patients registered at a practice between two dates
who have a complete history.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>end_date</code></td>
<td>
<p>end date of interest of period as a string with the format <code>YYYY-MM-DD</code>.
Together with start date, this filters results to patients registered at a practice between two dates
who have a complete history.</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary containing an expectation definition defining an <code>incidence</code>
between <code>0</code> and <code>1</code>.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of integers of <code>1</code> or <code>0</code></p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>This creates a variable <code>has_consultation_history</code> with patient returning an integer of <code>1</code> if
patient registered at one practice between two dates and has a completed record. Patients who are
not registered with a complete record return an integer of <code>0</code>.</p>
<div class="highlight">
<pre><span></span><code>has_consultation_history=patients.with_complete_gp_consultation_history_between(
    start_date="2019-02-01",
    end_date="2020-01-31",
    return_expectations={"incidence": 0.9},
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.with_death_recorded_in_cpns">

        <code class="highlight language-python">
with_death_recorded_in_cpns<span class="p">(</span><span class="n">on_or_before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_after</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">returning</span><span class="o">=</span><span class="s1">'binary_flag'</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_month</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_day</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.with_death_recorded_in_cpns" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Identify patients who with death registered in CPNS dataset</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>on_or_before</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results
on or before the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>on_or_after</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results
on or after the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>between</code></td>
<td>
<p>two dates of interest as a list with each date as a string with the format <code>YYYY-MM-DD</code>.
Filters results to between the two dates provided. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>returning</code></td>
<td>
<p>a string indicating what type of value should be returned. The options are:
date_of_death: Date of death
binary_flag: If they died or not</p>
</td>
<td><code>'binary_flag'</code></td>
</tr>
<tr>
<td><code>date_format</code></td>
<td>
<p>a string detailing the format of the dates to be returned. It can be <code>YYYY-MM-DD</code>,
<code>YYYY-MM</code> or <code>YYYY</code> and wherever possible the least disclosive data should be returned. i.e returning
only year is less disclosive than a date with day, month and year.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>include_month</code></td>
<td>
<p>a boolean indicating if day should be included in addition to year (deprecated: use
<code>date_format</code> instead).</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>include_day</code></td>
<td>
<p>a boolean indicating if day should be included in addition to year and
month (deprecated: use <code>date_format</code> instead).</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary defining the incidence and distribution of expected value
within the population in question.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of integers of <code>1</code> or <code>0</code> if <code>returning</code> argument is set to <code>binary_flag</code>;
    list of strings with a date format returned if <code>returning</code> argument is set to <code>date_of_death</code></p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>A variable called <code>died_date_cpns</code> is created that returns the date of death for
any patients have died in the <abbr title="Covid-19 Patient Notification System - the route by which NHS England are informed of COVID-19-positive, deaths in hospital">CPNS</abbr> dataset.</p>
<div class="highlight">
<pre><span></span><code>died_date_cpns=patients.with_death_recorded_in_cpns(
    on_or_after="2020-02-01",
    returning="date_of_death",
    include_month=True,
    include_day=True,
    return_expectations={
        "date": {"earliest" : "2020-02-01"},
        "rate" : "exponential_increase"
    },
),
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.with_death_recorded_in_primary_care">

        <code class="highlight language-python">
with_death_recorded_in_primary_care<span class="p">(</span><span class="n">on_or_before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_after</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">returning</span><span class="o">=</span><span class="s1">'binary_flag'</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.with_death_recorded_in_primary_care" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Identify patients with a date-of-death in their primary care record.</p>
<p>There is generally a lag between the death being recorded in ONS data and
appearing in the primary care record, but the date itself is usually
reliable when it appears. By contrast, cause of death is often not accurate
in the primary care record so we don't make it available to query here.</p>
<div class="highlight">
<pre><span></span><code>Args:
!!! on_or_before "date of interest as a string with the format `YYYY-MM-DD`. Filters results"
    on or before the given date. The default value is `None`.
!!! on_or_after "date of interest as a string with the format `YYYY-MM-DD`. Filters results"
    on or after the given date. The default value is `None`.
!!! between "two dates of interest as a list with each date as a string with the format `YYYY-MM-DD`."
    Filters results to  between the two dates provided. The default value is `None`.
!!! returning "a string indicating what type of value should be returned. The options are:"
    date_of_death: Date of death
    binary_flag: If they died or not
!!! date_format "a string detailing the format of the dates to be returned. It can be `YYYY-MM-DD`,"
    `YYYY-MM` or `YYYY` and wherever possible the least disclosive data should be returned. i.e returning
    only year is less disclosive than a date with day, month and year.
!!! return_expectations "a dictionary defining the incidence and distribution of expected value"
    within the population in question.
</code></pre>
</div>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of integers of <code>1</code> or <code>0</code> if <code>returning</code> argument is set to <code>binary_flag</code>;
    list of strings with a date format returned if <code>returning</code> argument is set to <code>date_of_death</code></p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>A variable called <code>died_date_gp</code> is created that returns the date of death for
any patients have died in the GP dataset.</p>
<div class="highlight">
<pre><span></span><code>died_date_gp=patients.with_death_recorded_in_primary_care(
    on_or_after="2020-02-01",
    returning="date_of_death",
    return_expectations={
        "date": {"earliest" : "2020-02-01"},
        "rate" : "exponential_increase"
    },
),
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.with_gp_consultations">

        <code class="highlight language-python">
with_gp_consultations<span class="p">(</span><span class="n">on_or_before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_after</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">find_first_match_in_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">find_last_match_in_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">returning</span><span class="o">=</span><span class="s1">'binary_flag'</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.with_gp_consultations" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>These are GP-patient interactions, either in person or via phone/video
call. The concept of a "consultation" in EHR systems is generally broader
and might include things like updating a phone number with the
receptionist.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>on_or_before</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to
on or before the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>on_or_after</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to
on or after the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>between</code></td>
<td>
<p>two dates of interest as a list with each date as a string with the format <code>YYYY-MM-DD</code>.
Filters results to between the two dates provided. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>find_first_match_in_period</code></td>
<td>
<p>a boolean that indicates if the data returned is first event
if there are multiple matches within the time period</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>find_last_match_in_period</code></td>
<td>
<p>a boolean that indicates if the data returned is last event
if there are multiple matches within the time period</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>returning</code></td>
<td>
<p>a string indicating what type of value should be returned. The options are limited to binary_flag
(which indicates if they have had the an event or not), date (which indicate date of event and used
with either find_first_match_in_period or find_last_match_in_period), or number_of_matches_in_period
(which counts the events in the period)</p>
</td>
<td><code>'binary_flag'</code></td>
</tr>
<tr>
<td><code>date_format</code></td>
<td>
<p>a string detailing the format of the dates to be returned. It can be <code>YYYY-MM-DD</code>,
<code>YYYY-MM</code> or <code>YYYY</code> and wherever possible the least disclosive data should be returned. i.e returning
only year is less disclosive than a date with day, month and year.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary defining the incidence and distribution of expected value
within the population in question.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of integers of <code>1</code> or <code>0</code> if <code>returning</code> argument is set to <code>binary_flag</code>;
    list of strings with a date format returned if <code>returning</code> argument is set to <code>date</code>; a list of
    integers if <code>returning</code> argument is set to number_of_matches_in_period</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>A variable called <code>gp_count</code> is created that counts number of GP consultation between two dates in
2019.</p>
<div class="highlight">
<pre><span></span><code>gp_count=patients.with_gp_consultations(
    between=["2019-01-01", "2020-12-31"],
    returning="number_of_matches_in_period",
    return_expectations={
        "int": {"distribution": "normal", "mean": 6, "stddev": 3},
        "incidence": 0.6,
    },
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.with_high_cost_drugs">

        <code class="highlight language-python">
with_high_cost_drugs<span class="p">(</span><span class="n">drug_name_matches</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_after</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">returning</span><span class="o">=</span><span class="s1">'binary_flag'</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">find_first_match_in_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">find_last_match_in_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.with_high_cost_drugs" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Returns data from the High Cost Drugs Dataset</p>
<p>More details available in this notebook:
https://github.com/opensafely/highcostdrugs-research/blob/master/analysis/High%20Cost%20Drugs%20Dataset.ipynb</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>drug_name_matches</code></td>
<td>
<p>a drug name as a string, or a list of such names, or
a codelist containing such names. Results will be filtered to just
rows matching any of the supplied names exactly. Note these are not
standardised names, they are just the names however they come to us
in the original data.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>returning</code></td>
<td>
<p>a string indicating what type of value should be returned. Options are:
binary_flag: if the patient received any matching drugs
date: date drug received</p>
</td>
<td><code>'binary_flag'</code></td>
</tr>
<tr>
<td><code>on_or_before</code></td>
<td>
<p>as described elsewhere</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>on_or_after</code></td>
<td>
<p>as described elsewhere</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>between</code></td>
<td>
<p>as described elsewhere</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>find_first_match_in_period</code></td>
<td>
<p>as described elsewhere</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>find_last_match_in_period</code></td>
<td>
<p>as described elsewhere</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>date_format</code></td>
<td>
<p>only "YYYY" and "YYYY-MM" supported here as day level data
not available</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>as described elsewhere</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>The first month in which each patient received "ACME Drug" after March
2019:</p>
<div class="highlight">
<pre><span></span><code>covid_admission_date=patients.with_high_cost_drugs(
    drug_name_matches="ACME Drug",
    on_or_after="2019-03-01",
    find_first_match_in_period=True,
    returning="date",
    date_format="YYYY-MM",
    return_expectations={"date": {"earliest": "2019-03-01"}},
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.with_test_result_in_sgss">

        <code class="highlight language-python">
with_test_result_in_sgss<span class="p">(</span><span class="n">pathogen</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">test_result</span><span class="o">=</span><span class="s1">'any'</span><span class="p">,</span> <span class="n">on_or_before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_after</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">find_first_match_in_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">find_last_match_in_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">returning</span><span class="o">=</span><span class="s1">'binary_flag'</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.with_test_result_in_sgss" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Finds lab test results recorded in SGSS (Second Generation Surveillance
System).</p>
<p>Please note for the dates this is used in the database as the date the specimen was taken, rather than the
date of the lab result.</p>
<p>There's an important caveat here: where a patient has multiple positive
tests, SGSS groups these into "episodes" (referred to as
"Organism-Patient-Illness-Episodes"). Each pathogen has a maximum episode
duration (usually 2 weeks) and unless positive tests are separated by
longer than this period they are assumed to be the same episode of illness.
The specimen date recorded is the <em>earliest</em> positive specimen within the
episode.</p>
<p>For SARS-CoV-2 the episode length has been set to infinity, meaning that
once a patient has tested positive every positive test will be part of the
same episode and record the same specimen date.</p>
<p>This means that using <code>find_last_match_in_period</code> is pointless when
querying for positive results as only one date will ever be recorded and it
will be the earliest.</p>
<p>Our natural assumption, though it doesn't seem to be explicity stated in
the documentation, is that every negative result is treated as unique.</p>
<p>For more detail on SGSS in general see:
https://assets.publishing.service.gov.uk/government/uploads/system/uploads/attachment_data/file/739854/PHE_Laboratory_Reporting_Guidelines.pdf</p>
<p>Information about the SARS-CoV-2 episode length was via email from someone
at the National Infection Service:</p>
<div class="highlight">
<pre><span></span><code>The COVID-19 episode length in SGSS was set to indefinite, so all
COVID-19 records from a single patient will be classified as one
episode. This may change, but is set as it is due to limited
information around re-infection and virus clearance.
</code></pre>
</div>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pathogen</code></td>
<td>
<p>pathogen we are interested in. Only SARS-CoV-2 results are included in our data extract so this
will throw an error if the specified pathogen is anything other than
"SARS-CoV-2".</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>test_result</code></td>
<td>
<p>must be one of "positive", "negative" or "any"</p>
</td>
<td><code>'any'</code></td>
</tr>
<tr>
<td><code>on_or_before</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to
on or before the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>on_or_after</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to
on or after the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>between</code></td>
<td>
<p>two dates of interest as a list with each date as a string with the format <code>YYYY-MM-DD</code>.
Filters results to between the two dates provided. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>find_first_match_in_period</code></td>
<td>
<p>a boolean that indicates if the data returned is first event
if there are multiple matches within the time period</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>find_last_match_in_period</code></td>
<td>
<p>a boolean that indicates if the data returned is last event
if there are multiple matches within the time period</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>returning</code></td>
<td>
<p>a string indicating what type of value should be returned. The options are limited to binary_flag
(which indicates if they have had the an event or not) and date (which indicate date of event and used
with either find_first_match_in_period or find_last_match_in_period)</p>
</td>
<td><code>'binary_flag'</code></td>
</tr>
<tr>
<td><code>date_format</code></td>
<td>
<p>a string detailing the format of the dates to be returned. It can be <code>YYYY-MM-DD</code>,
<code>YYYY-MM</code> or <code>YYYY</code> and wherever possible the least disclosive data should be returned. i.e returning
only year is less disclosive than a date with day, month and year.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary defining the incidence and distribution of expected value
within the population in question.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of integers of <code>1</code> or <code>0</code> if <code>returning</code> argument is set to <code>binary_flag</code>;
    list of strings with a date format returned if <code>returning</code> argument is set to <code>date</code>;</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>Two variables are created. One called <code>first_tested_for_covid</code> is the first date that a patient has a
covid test never mind the result. The second called <code>first_positive_test_date</code> is the first date
that a patient has a positive test result.</p>
<div class="highlight">
<pre><span></span><code>first_tested_for_covid=patients.with_test_result_in_sgss(
    pathogen="SARS-CoV-2",
    test_result="any",
    on_or_after="2020-02-01",
    find_first_match_in_period=True,
    returning="date",
    date_format="YYYY-MM-DD",
    return_expectations={
        "date": {"earliest" : "2020-02-01"},
        "rate" : "exponential_increase"
    },
),
first_positive_test_date=patients.with_test_result_in_sgss(
    pathogen="SARS-CoV-2",
    test_result="positive",
    on_or_after="2020-02-01",
    find_first_match_in_period=True,
    returning="date",
    date_format="YYYY-MM-DD",
    return_expectations={
        "date": {"earliest" : "2020-02-01"},
        "rate" : "exponential_increase"
    },
),
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.with_these_clinical_events">

        <code class="highlight language-python">
with_these_clinical_events<span class="p">(</span><span class="n">codelist</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_after</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">find_first_match_in_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">find_last_match_in_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">returning</span><span class="o">=</span><span class="s1">'binary_flag'</span><span class="p">,</span> <span class="n">include_date_of_match</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_days_where_these_codes_occur</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">episode_defined_as</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_binary_flag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_number_of_matches_in_period</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_first_date_in_period</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_last_date_in_period</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_month</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_day</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.with_these_clinical_events" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Patients who have had at least one of these clinical events in the defined
period</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>codelist</code></td>
<td>
<p>a codelist for requested event(s)</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary defining the incidence and distribution of expected value
within the population in question. If returning an integer (<code>returning=number_of_matches_in_period</code>
or <code>returning=number_of_episodes</code>), this is a 2-item key-value dictionary of <code>int</code> and <code>incidence</code>.
<code>int</code> is a dictionary of <code>distribution</code>, <code>mean</code>, and <code>stddev</code>. These values determine
the shape of the dummy data returned, and the int means a int will be returned rather than a
float. <code>incidence</code> must have a value and this is what percentage of dummy patients have
a value. It needs to be a number between 0 and 1. If returning <code>binary_flag</code> this is a 1-item
dictionary of <code>incidence</code> as described above. If returning either <code>first_date_in_period</code> or
<code>last_date_in_period</code>, this is a 2-item dictionary of <code>date</code> and <code>incidence</code>. <code>date</code> is a dict
of <code>earliest</code> and/or <code>latest</code> date possible.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>on_or_before</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to on or
before the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>on_or_after</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to
on or after the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>between</code></td>
<td>
<p>two dates of interest as a list with each date as a string with the format <code>YYYY-MM-DD</code>.
Filters results to between the two dates provided. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>returning</code></td>
<td>
<p>a str defining the type of data to be returned. Options include <code>binary_flag</code>, <code>date</code>,
<code>number_of_matches_in_period</code>, <code>number_of_episodes</code>, <code>code</code>, <code>category</code>, or <code>numeric_value</code>.
The default value is <code>binary_flag</code>.</p>
</td>
<td><code>'binary_flag'</code></td>
</tr>
<tr>
<td><code>find_first_match_in_period</code></td>
<td>
<p>a boolean indicating if any returned date, code, category, or numeric value
should be based on the first match in the period.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>find_last_match_in_period</code></td>
<td>
<p>a boolean indicating if any returned date, code, category, or numeric value
should be based on the last match in the period.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>include_date_of_match</code></td>
<td>
<p>a boolean indicating if an extra column should be included in the output.
The default value is <code>False</code>.</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>date_format</code></td>
<td>
<p>a string detailing the format of the dates to be returned. It can be <code>YYYY-MM-DD</code>,
<code>YYYY-MM</code> or <code>YYYY</code> and wherever possible the least disclosive data should be returned. i.e returning
only year is less disclosive than a date with day, month and year. Only used if include_date_of_match
is <code>True</code></p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>ignore_days_where_these_codes_occur</code></td>
<td>
<p>a codelist that contains codes for events to be
ignored. if a events is found on this day, the date is not matched even it matches a
code in the main <code>codelist</code></p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>episode_defined_as</code></td>
<td>
<p>a string expression indicating how an episode should be defined</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>return_binary_flag</code></td>
<td>
<p>a boolean indicating if the number of matches in a period should be
returned (deprecated: use <code>date_format</code> instead),</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>return_number_of_matches_in_period</code></td>
<td>
<p>a boolean indicating if the number of matches in a period should be
returned (deprecated: use <code>date_format</code> instead)</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>return_first_date_in_period</code></td>
<td>
<p>a boolean indicating if the first matches in a period should be
returned (deprecated: use <code>date_format</code> instead)</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>return_last_date_in_period</code></td>
<td>
<p>a boolean indicating if the last matches in a period should be
returned (deprecated: use <code>date_format</code> instead)</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>include_month</code></td>
<td>
<p>a boolean indicating if day should be included in addition to year (deprecated: use
<code>date_format</code> instead).</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>include_day</code></td>
<td>
<p>a boolean indicating if day should be included in addition to year and
month (deprecated: use <code>date_format</code> instead).</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of integers of <code>1</code> or <code>0</code> if <code>returning</code> argument is set to <code>binary_flag</code>, <code>number_of_episodes</code>
    or <code>number_of_matches_in_period</code>; list of strings with a date format returned if <code>returning</code>
    argument is set to <code>first_date_in_period</code> or <code>last_date_in_period</code>. a list of strings with a category
    represented in an extra column in the <abbr title="a collection of clinical codes that define a particular condition, event or diagnosis.">codelist</abbr> object <code>category</code> is returned.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>This creates a variable <code>haem_cancer</code> returning the first date of a diagnosis of haematology
malignancy within the time period.</p>
<div class="highlight">
<pre><span></span><code>haem_cancer=patients.with_these_clinical_events(
    haem_cancer_codes,
    between=["2015-03-01", "2020-02-29"],
    returning="date",
    find_first_match_in_period=True,
    return_expectations={"date": {earliest; "2015-03-01", "latest": "2020-02-29"}},
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.with_these_codes_on_death_certificate">

        <code class="highlight language-python">
with_these_codes_on_death_certificate<span class="p">(</span><span class="n">codelist</span><span class="p">,</span> <span class="n">on_or_before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_after</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">match_only_underlying_cause</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">returning</span><span class="o">=</span><span class="s1">'binary_flag'</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">include_month</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_day</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.with_these_codes_on_death_certificate" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Identify patients with ONS-registered death, where cause of death
matches the supplied icd10 codelist</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>codelist</code></td>
<td>
<p>a codelist for requested value</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>on_or_before</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results
on or before the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>on_or_after</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results
on or after the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>between</code></td>
<td>
<p>two dates of interest as a list with each date as a string with the format <code>YYYY-MM-DD</code>.
Filters results between the two dates provided. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>match_only_underlying_cause</code></td>
<td>
<p>boolean for indicating if filters results to only specified cause of death.</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>returning</code></td>
<td>
<p>a string indicating what type of value should be returned. The options are:
date_of_death: Date of death
binary_flag: If they died or not
underlying_cause_of_death: The icd10 code corresponding to the underlying cause of death</p>
</td>
<td><code>'binary_flag'</code></td>
</tr>
<tr>
<td><code>date_format</code></td>
<td>
<p>a string detailing the format of the dates to be returned. It can be <code>YYYY-MM-DD</code>,
<code>YYYY-MM</code> or <code>YYYY</code> and wherever possible the least disclosive data should be returned. i.e returning
only year is less disclosive than a date with day, month and year.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>include_month</code></td>
<td>
<p>a boolean indicating if day should be included in addition to year (deprecated: use
<code>date_format</code> instead).</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>include_day</code></td>
<td>
<p>a boolean indicating if day should be included in addition to year and
month (deprecated: use <code>date_format</code> instead).</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary defining the incidence and distribution of expected value
within the population in question.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of integers of <code>1</code> or <code>0</code> if <code>returning</code> argument is set to <code>binary_flag</code> or <code>underlying_cause_of_death</code>;
    list of strings with a date format returned if <code>returning</code> argument is set to <code>date_of_death</code></p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>A variable called <code>died_ons_covid_flag_any</code> is created that returns the date of death for
any patients that have covid on their death certificate even if that is the not the underlying cause
of death.</p>
<div class="highlight">
<pre><span></span><code>died_ons_covid_flag_any=patients.with_these_codes_on_death_certificate(
    covid_codelist,
    on_or_after="2020-02-01",
    match_only_underlying_cause=False,
    return_expectations={
        "date": {"earliest" : "2020-02-01"},
        "rate" : "exponential_increase"
    },
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.with_these_medications">

        <code class="highlight language-python">
with_these_medications<span class="p">(</span><span class="n">codelist</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_after</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">find_first_match_in_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">find_last_match_in_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">returning</span><span class="o">=</span><span class="s1">'binary_flag'</span><span class="p">,</span> <span class="n">include_date_of_match</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_days_where_these_clinical_codes_occur</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">episode_defined_as</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_binary_flag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_number_of_matches_in_period</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_first_date_in_period</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_last_date_in_period</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_month</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_day</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.with_these_medications" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Patients who have been prescribed at least one of this list of medications
in the defined period</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>codelist</code></td>
<td>
<p>a codelist for requested medication(s)</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary defining the incidence and distribution of expected value
within the population in question. If returning an integer (returning number_of_matches_in_period,
number_of_episodes), this is a 2-item key-value dictionary of <code>int</code> and <code>incidence</code>.
<code>int</code> is a dictionary of <code>distribution</code>, <code>mean</code>, and <code>stddev</code>. These values determine
the shape of the dummy data returned, and the int means a int will be returned rather than a
float. <code>incidence</code> must have a value and this is what percentage of dummy patients have
a value. It needs to be a number between 0 and 1. If returning <code>binary_flag</code> this is a 1-item
dictionary of <code>incidence</code> as described above. If returning either <code>first_date_in_period</code> or
<code>last_date_in_period</code>, this is a 2-item dictionary of <code>date</code> and <code>incidence</code>. <code>date</code> is a dict
of <code>earliest</code> and/or <code>latest</code> date possible.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>on_or_before</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to on or
before the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>on_or_after</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to
on or after the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>between</code></td>
<td>
<p>two dates of interest as a list with each date as a string with the format <code>YYYY-MM-DD</code>.
Filters results to between the two dates provided. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>returning</code></td>
<td>
<p>a str defining the type of data to be returned. Options include <code>binary_flag</code>, <code>date</code>,
<code>number_of_matches_in_period</code>, <code>number_of_episodes</code>, <code>code</code>, <code>category</code>.
The default value is <code>binary_flag</code>.</p>
</td>
<td><code>'binary_flag'</code></td>
</tr>
<tr>
<td><code>find_first_match_in_period</code></td>
<td>
<p>a boolean indicating if any returned date, code, category, or numeric value
should be based on the first match in the period.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>find_last_match_in_period</code></td>
<td>
<p>a boolean indicating if any returned date, code, category, or numeric value
should be based on the last match in the period.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>include_date_of_match</code></td>
<td>
<p>a boolean indicating if an extra column should be included in the output.
The default value is <code>False</code>.</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>date_format</code></td>
<td>
<p>a string detailing the format of the dates to be returned. It can be <code>YYYY-MM-DD</code>,
<code>YYYY-MM</code> or <code>YYYY</code> and wherever possible the least disclosive data should be returned. i.e returning
only year is less disclosive than a date with day, month and year. Only used if include_date_of_match
is <code>True</code></p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>ignore_days_where_these_clinical_codes_occur</code></td>
<td>
<p>a codelist that contains codes for medications to be
ignored. if a medication is found on this day, the date is not matched even it matches a
code in the main <code>codelist</code></p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>episode_defined_as</code></td>
<td>
<p>a string expression indicating how an episode should be defined</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>return_binary_flag</code></td>
<td>
<p>a bool indicatin if a binary flag should be returned (deprecated: use <code>date_format</code> instead)</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>return_number_of_matches_in_period</code></td>
<td>
<p>a boolean indicating if the number of matches in a period should be
returned (deprecated: use <code>date_format</code> instead)</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>return_first_date_in_period</code></td>
<td>
<p>a boolean indicating if the first matches in a period should be
returned (deprecated: use <code>date_format</code> instead)</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>return_last_date_in_period</code></td>
<td>
<p>a boolean indicating if the last matches in a period should be
returned (deprecated: use <code>date_format</code> instead)</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>include_month</code></td>
<td>
<p>a boolean indicating if day should be included in addition to year (deprecated: use
<code>date_format</code> instead).</p>
</td>
<td><code>False</code></td>
</tr>
<tr>
<td><code>include_day</code></td>
<td>
<p>a boolean indicating if day should be included in addition to year and
month (deprecated: use <code>date_format</code> instead).</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of integers of <code>1</code> or <code>0</code> if <code>returning</code> argument is set to <code>binary_flag</code>, <code>number_of_episodes</code>
    or <code>number_of_matches_in_period</code>; list of strings with a date format returned if <code>returning</code>
    argument is set to <code>first_date_in_period</code> or <code>last_date_in_period</code>.</p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>This creates a variable <code>exacerbation_count</code> returning an int of the number of episodes of oral
steroids being prescribed within the time period where a prescription is counted as part of the same
episode if it falls within 28 days of a previous prescription. Days where oral steroids
are prescribed on the same day as a COPD review are also ignored as may not represent true exacerbations.</p>
<div class="highlight">
<pre><span></span><code>exacerbation_count=patients.with_these_medications(
    oral_steroid_med_codes,
    between=["2019-03-01", "2020-02-29"],
    ignore_days_where_these_clinical_codes_occur=copd_reviews,
    returning="number_of_episodes",
    episode_defined_as="series of events each &lt;= 28 days apart",
    return_expectations={
        "int": {"distribution": "normal", "mean": 2, "stddev": 1},
        "incidence": 0.2,
    },
)
</code></pre>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="cohortextractor.patients.with_tpp_vaccination_record">

        <code class="highlight language-python">
with_tpp_vaccination_record<span class="p">(</span><span class="n">target_disease_matches</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">product_name_matches</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_before</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">on_or_after</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">between</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">returning</span><span class="o">=</span><span class="s1">'binary_flag'</span><span class="p">,</span> <span class="n">date_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">find_first_match_in_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">find_last_match_in_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_expectations</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>        </code>


      <a class="headerlink" href="#cohortextractor.patients.with_tpp_vaccination_record" title="Permanent link">&#128279;</a></h5>
<div class="doc doc-contents ">
<p>Identify patients with a vaccination record for a target disease within the tpp vaccination record</p>
<p>Vaccinations can be recorded via a Vaccination Record or via prescription of a vaccine i.e a product code.</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>target_disease_matches</code></td>
<td>
<p>the target disease as a string</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>product_name_matches</code></td>
<td>
<p>the product name as a string</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>on_or_before</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to
on or before the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>on_or_after</code></td>
<td>
<p>date of interest as a string with the format <code>YYYY-MM-DD</code>. Filters results to
on or after the given date. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>between</code></td>
<td>
<p>two dates of interest as a list with each date as a string with the format <code>YYYY-MM-DD</code>.
Filters results to between the two dates provided. The default value is <code>None</code>.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>returning</code></td>
<td>
<p>a string indicating what type of value should be returned. The options are limited to binary_flag
(which indicates if they have had the vaccination or not) or a date of vaccination</p>
</td>
<td><code>'binary_flag'</code></td>
</tr>
<tr>
<td><code>date_format</code></td>
<td>
<p>a string detailing the format of the dates to be returned. It can be <code>YYYY-MM-DD</code>,
<code>YYYY-MM</code> or <code>YYYY</code> and wherever possible the least disclosive data should be returned. i.e returning
only year is less disclosive than a date with day, month and year.</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>find_first_match_in_period</code></td>
<td>
<p>a boolean that indicates if the data returned is first indication of vaccination
if there are multiple matches within the time period</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>find_last_match_in_period</code></td>
<td>
<p>a boolean that indicates if the data returned is last indication of vaccination
if there are multiple matches within the time period</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>return_expectations</code></td>
<td>
<p>a dictionary defining the incidence and distribution of expected value
within the population in question.</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>of integers of <code>1</code> or <code>0</code> if <code>returning</code> argument is set to <code>binary_flag</code>;
    list of strings with a date format returned if <code>returning</code> argument is set to <code>date</code></p>
</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<p>A variable called <code>flu_vaccine</code> is created that returns the date of vaccination for
any patients in the GP dataset between 2 dates.</p>
<div class="highlight">
<pre><span></span><code>flu_vaccine=patients.with_tpp_vaccination_record(
    target_disease_matches="influenza",
    between=["2019-09-01", "2020-04-01"],
    returning="date",
    date_format="YYYY-MM",
    find_first_match_in_period=True,
    return_expectations={
        date": {"earliest": "2019-09-01", "latest": "2020-03-29"}
    }
),
</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.6a3d08fc.min.js"></script>
      <script src="../assets/javascripts/bundle.71201edf.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>